...
green_t *next = dequeue(&rq);
running = next;
swapcontext(susp->context, next->context);
...